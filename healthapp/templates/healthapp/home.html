{% extends 'base.html' %}
{% load static %}
{% load dict_extras %}

{% block content %}
<link rel="stylesheet" href="{% static 'healthapp/css/style.css' %}">
<link rel="stylesheet" href="{% static 'healthapp/css/home.css' %}">

<h1>Home</h1>

<section>
    <h2>理想の行動時間</h2>

    {% if ideal_times %}
        <ul class="ideal-list">
					{% for item in chart_data.legend %}
							<li>
									<span class="legend-color" style="background-color: {{ item.color }}"></span>
									{{ item.label }}：
									{% if ideal_times|get_item:item.category_id %}
											{{ ideal_times|get_item:item.category_id }} 時間
									{% else %}
											未設定
									{% endif %}
							</li>
					{% endfor %}
        </ul>
    {% else %}
        <p>理想の行動時間が設定されていません。</p>
    {% endif %}
		<div class="ideal-setting-link">
			<a href="{% url 'healthapp:ideal_time' %}">
					理想の行動時間を設定する
			</a>
		</div>
</section>

<section>
    <h2>行動ログ</h2>

    {% if chart_data.groups %}
        <div class="band-legend">
            {% for item in chart_data.legend %}
                <span class="legend-item">
                    <span
                        class="legend-color"
                        style="background-color: {{ item.color }};"
                    ></span>
                    {{ item.label }}
                </span>
            {% endfor %}
        </div>

        <div class="band-chart">
            {% for group in chart_data.groups %}
                <div class="band-row">
                    <div class="band-date">
                        {{ group.date }}
                    </div>

                    <div class="band-bar">
                        {% for segment in group.segments %}
                            <div
                                class="band-segment"
                                style="
                                    width: {{ segment.percent }}%;
                                    background-color: {{ segment.color }};
                                "
                                title="{{ segment.label }}: {{ segment.hours }}時間"
                            ></div>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>行動ログがありません。</p>
    {% endif %}
</section>

{% endblock %}
